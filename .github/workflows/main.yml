name: Run Selenium Scraper

on:
  schedule:
    - cron: "0 6 * * *"   # runs every day at 06:00 UTC
  workflow_dispatch:       # allows manual trigger

jobs:
  run-scraper:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v3

      - name: Install Chrome
        run: |
          sudo apt-get update
          sudo apt-get install -y wget gnupg unzip
          wget -q https://dl.google.com/linux/direct/google-chrome-stable_current_amd64.deb
          sudo apt-get install -y ./google-chrome-stable_current_amd64.deb || \
            (sudo apt-get -f install -y && sudo apt-get install -y ./google-chrome-stable_current_amd64.deb)

      - name: Install Python dependencies
        run: |
          pip install pandas selenium webdriver-manager notebook nbconvert

          

      - name: Run Selenium notebook
        run: |
          jupyter nbconvert \
            --to notebook \
            --execute bronze_databricks_incident_history.ipynb \
            --output output.ipynb

      - name: Commit updated CSV
        run: |
          git config --global user.email "automation-bot@example.com"
